name: build nginx maintenance website

on:
  push:
    branches: [ master ]

jobs:

  build:
    name: Build
    runs-on: self-hosted
    steps:
    - name: check path current local
      run: pwd

    - name: Delete container for maintenance old
      run: sudo docker rm -f nginx_mode_maintenance

    - name: Delete repo maintenance old
      run: sudo rm -rf nginx-maintenance

    - name: Delete repo maintenance old directory HOME
      run: sudo rm -rf /home/nginx-maintenance
      
    - name: Delete repo maintenance old
      run: sudo rm -rf nginx-maintenance

    - name: Clone project maintenance
      run: git clone https://github.com/tainguyenbp/nginx-maintenance.git

    - name: Check path projec maintenance new
      run: ls -ahl

    - name: Copy repo clone to home directory
      run: sudo scp -r nginx-maintenance /home/

    - name: Check path projec maintenance copy
      run: ls -ahl
      
    - name: build project maintenance new
      run: sudo cd /home/nginx-maintenance  && sudo docker-compose up -d --build
    
